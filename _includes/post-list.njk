{%- css %}.post-list { counter-reset: start-from {{ (postListCounter or postList.length) + 1 }} }{% endcss %}
{%- css %}{% include "11ty-theme/css/post-list.css" %}{% endcss %}

{# Posts #}
{% for post in postList %}
	<article class="border-bottom-section">
		<h2 class="post-list-item-title"><a href="{{ post.url }}" class="post-list-item-link">{% if post.data.title %}{{ post.data.title }}{% else %}<code>{{ post.url }}</code>{% endif %}</a></h2>
		<div class="post-list-metadata">
			<p class="post-list-item-time-container"><time class="post-list-item-time" datetime="{{ post.date | htmlDateString }}">{{ post.date | readableDate("LLLL d, yyyy") }}</time></p>
			{% if post.data.tags | filterTagList | length %}
				<p>Tags:
				{%- for tag in post.data.tags | filterTagList %}
					{%- set tagUrl %}/tags/{{ tag | slugify }}/{% endset %}
					<a href="{{ tagUrl }}" class="post-list-tag">{{ tag }}</a>{%- if not loop.last %}, {% endif %}
				{%- endfor %}
				</p>
			{% endif %}
		</div>
		{% if post.data.description %}<p class="post-list-item-description">{{ post.data.description }}</p>{% endif %}
	</article>
{% endfor %}

{# Pagination #}
{% if pagination and pagination.totalPages > 1 %}
	<nav aria-labelledby="posts-pagination">
		<h2 class="posts-pagination visually-hidden">Pagination Links to More Posts</h2>
		<ul class="pager">
			{%- set currentIndex = pagination.pageNumber %}
			{%- if currentIndex > 0 %}
				<li><a href="{{ pagination.href.first }}" class="icon-before pager-first">First</a></li>
			{% endif %}

			{%- if pagination.totalPages <= 7 %}
				{%- for pageEntry in pagination.pages %}
					<li>
						<a href="{{ pagination.hrefs[ loop.index0 ] }}"{% if currentIndex == loop.index0 %} aria-current="page"{% endif %}>{{ loop.index }}</a>
					</li>
				{%- endfor %}
			{%- else %}
				{%- set startIndex = currentIndex - 2 %}
				{%- set endIndex = currentIndex + 2 %}
				{%- for pageEntry in pagination.pages %}
					{%- if loop.index0 >= startIndex and loop.index0 <= endIndex %}
						<li>
							<a href="{{ pagination.hrefs[ loop.index0 ] }}"{% if currentIndex == loop.index0 %} aria-current="page"{% endif %}>{{ loop.index }}</a>
						</li>
					{%- endif %}
				{%- endfor %}
			{%- endif %}

			{%- if currentIndex < pagination.totalPages - 1 %}
				<li><a href="{{ pagination.href.last }}" class="icon-after pager-last">Last ({{ pagination.totalPages }})</a></li>
			{% endif %}
		</ul>
	</nav>
{% endif %}
